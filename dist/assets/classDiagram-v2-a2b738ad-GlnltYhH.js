var H=Object.defineProperty;var A=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable;var $=(l,e,n)=>e in l?H(l,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):l[e]=n,k=(l,e)=>{for(var n in e||(e={}))V.call(e,n)&&$(l,n,e[n]);if(A)for(var n of A(e))W.call(e,n)&&$(l,n,e[n]);return l};var I=(l,e,n)=>new Promise((i,t)=>{var c=o=>{try{r(n.next(o))}catch(a){t(a)}},s=o=>{try{r(n.throw(o))}catch(a){t(a)}},r=o=>o.done?i(o.value):Promise.resolve(o.value).then(c,s);r((n=n.apply(l,e)).next())});import{p as J,d as M,s as K}from"./styles-b83b31c9-BrGB_7ER.js";import{l as p,c as d,h as S,y as Q,t as U,o as B,q as G,n as q,j as z}from"./ChatView-DtxTt3pK.js";import{G as X}from"./graph-3o0KS7ni.js";import{r as Y}from"./index-01f381cb-C4sEOUNS.js";import"./index-CA9x9sQ-.js";import"./layout-5OWJZfHR.js";import"./index-xOaNmHsD.js";import"./constants-B3sxij0k.js";import"./VueLiveEditor-iJCZjxuU.js";import"./status-BfqA-n-h.js";import"./clone-DTf53SI5.js";import"./edges-066a5561-BQc2emor.js";import"./createText-ca0c5216-t_bGVQjA.js";import"./line-AdEud9Xu.js";import"./array-BKyUJesY.js";import"./path-wcoxYG6a.js";import"//at.alicdn.com/t/c/font_4565805_mtkshfnyzag.js";const L=l=>z.sanitizeText(l,d());let T={dividerMargin:10,padding:5,textHeight:10,curve:void 0};const Z=function(l,e,n,i){const t=Object.keys(l);p.info("keys:",t),p.info(l),t.forEach(function(c){var y;var s,r;const o=l[c],f={shape:"rect",id:o.id,domId:o.domId,labelText:L(o.id),labelStyle:"",style:"fill: none; stroke: black",padding:(y=(s=d().flowchart)==null?void 0:s.padding)!=null?y:(r=d().class)==null?void 0:r.padding};e.setNode(o.id,f),P(o.classes,e,n,i,o.id),p.info("setNode",f)})},P=function(l,e,n,i,t){const c=Object.keys(l);p.info("keys:",c),p.info(l),c.filter(s=>l[s].parent==t).forEach(function(s){var x,u;var r,o;const a=l[s],f=a.cssClasses.join(" "),y=B(a.styles),h=(x=a.label)!=null?x:a.id,m=0,b={labelStyle:y.labelStyle,shape:"class_box",labelText:L(h),classData:a,rx:m,ry:m,class:f,style:y.style,id:a.id,domId:a.domId,tooltip:i.db.getTooltip(a.id,t)||"",haveCallback:a.haveCallback,link:a.link,width:a.type==="group"?500:void 0,type:a.type,padding:(u=(r=d().flowchart)==null?void 0:r.padding)!=null?u:(o=d().class)==null?void 0:o.padding};e.setNode(a.id,b),t&&e.setParent(a.id,t),p.info("setNode",b)})},j=function(l,e,n,i){p.info(l),l.forEach(function(t,c){var u;var s,r;const o=t,a="",f={labelStyle:"",style:""},y=o.text,h=0,v={labelStyle:f.labelStyle,shape:"note",labelText:L(y),noteData:o,rx:h,ry:h,class:a,style:f.style,id:o.id,domId:o.id,tooltip:"",type:"note",padding:(u=(s=d().flowchart)==null?void 0:s.padding)!=null?u:(r=d().class)==null?void 0:r.padding};if(e.setNode(o.id,v),p.info("setNode",v),!o.class||!(o.class in i))return;const b=n+c,x={id:`edgeNote${b}`,classes:"relation",pattern:"dotted",arrowhead:"none",startLabelRight:"",endLabelLeft:"",arrowTypeStart:"none",arrowTypeEnd:"none",style:"fill:none",labelStyle:"",curve:G(T.curve,q)};e.setEdge(o.id,o.class,x,b)})},O=function(l,e){const n=d().flowchart;let i=0;l.forEach(function(t){var r;var c;i++;const s={classes:"relation",pattern:t.relation.lineType==1?"dashed":"solid",id:`id_${t.id1}_${t.id2}_${i}`,arrowhead:t.type==="arrow_open"?"none":"normal",startLabelRight:t.relationTitle1==="none"?"":t.relationTitle1,endLabelLeft:t.relationTitle2==="none"?"":t.relationTitle2,arrowTypeStart:R(t.relation.type1),arrowTypeEnd:R(t.relation.type2),style:"fill:none",labelStyle:"",curve:G(n==null?void 0:n.curve,q)};if(p.info(s,t),t.style!==void 0){const o=B(t.style);s.style=o.style,s.labelStyle=o.labelStyle}t.text=t.title,t.text===void 0?t.style!==void 0&&(s.arrowheadStyle="fill: #333"):(s.arrowheadStyle="fill: #333",s.labelpos="c",((r=(c=d().flowchart)==null?void 0:c.htmlLabels)!=null?r:d().htmlLabels)?(s.labelType="html",s.label='<span class="edgeLabel">'+t.text+"</span>"):(s.labelType="text",s.label=t.text.replace(z.lineBreakRegex,`
`),t.style===void 0&&(s.style=s.style||"stroke: #333; stroke-width: 1.5px;fill:none"),s.labelStyle=s.labelStyle.replace("color:","fill:"))),e.setEdge(t.id1,t.id2,s,i)})},tt=function(l){T=k(k({},T),l)},et=function(l,e,n,i){return I(this,null,function*(){var u,_,N,D;p.info("Drawing class - ",e);const t=(u=d().flowchart)!=null?u:d().class,c=d().securityLevel;p.info("config:",t);const s=(_=t==null?void 0:t.nodeSpacing)!=null?_:50,r=(N=t==null?void 0:t.rankSpacing)!=null?N:50,o=new X({multigraph:!0,compound:!0}).setGraph({rankdir:i.db.getDirection(),nodesep:s,ranksep:r,marginx:8,marginy:8}).setDefaultEdgeLabel(function(){return{}}),a=i.db.getNamespaces(),f=i.db.getClasses(),y=i.db.getRelations(),h=i.db.getNotes();p.info(y),Z(a,o,e,i),P(f,o,e,i),O(y,o),j(h,o,y.length+1,f);let m;c==="sandbox"&&(m=S("#i"+e));const v=c==="sandbox"?S(m.nodes()[0].contentDocument.body):S("body"),b=v.select(`[id="${e}"]`),x=v.select("#"+e+" g");if(yield Y(x,o,["aggregation","extension","composition","dependency","lollipop"],"classDiagram",e),Q.insertTitle(b,"classTitleText",(D=t==null?void 0:t.titleTopMargin)!=null?D:5,i.db.getDiagramTitle()),U(o,b,t==null?void 0:t.diagramPadding,t==null?void 0:t.useMaxWidth),!(t!=null&&t.htmlLabels)){const E=c==="sandbox"?m.nodes()[0].contentDocument:document,F=E.querySelectorAll('[id="'+e+'"] .edgeLabel .label');for(const w of F){const C=w.getBBox(),g=E.createElementNS("http://www.w3.org/2000/svg","rect");g.setAttribute("rx",0),g.setAttribute("ry",0),g.setAttribute("width",C.width),g.setAttribute("height",C.height),w.insertBefore(g,w.firstChild)}}})};function R(l){let e;switch(l){case 0:e="aggregation";break;case 1:e="extension";break;case 2:e="composition";break;case 3:e="dependency";break;case 4:e="lollipop";break;default:e="none"}return e}const ot={setConf:tt,draw:et},wt={parser:J,db:M,renderer:ot,styles:K,init:l=>{l.class||(l.class={}),l.class.arrowMarkerAbsolute=l.arrowMarkerAbsolute,M.clear()}};export{wt as diagram};
